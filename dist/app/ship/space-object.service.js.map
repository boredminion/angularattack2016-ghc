{"version":3,"file":"space-object.service.js","sourceRoot":"","sources":["space-object.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\nimport {AngularFire, FirebaseListObservable} from 'angularfire2';\nimport {ISpaceObject, AIShip, Asteroid, Explosion, Planet, SpaceObjectType} from './';\nimport {Direction} from '../map';\nimport {AuthService, User} from '../shared';\n\n@Injectable()\nexport class SpaceObjectService {\n\n\tspaceObjects: ISpaceObject[] = [];\n\tspaceObjects$: FirebaseListObservable<ISpaceObject[]>;\n\tSHIP_IMAGES: string[] = [\n\t\t'spaceship-300x165.png',\n\t\t'spaceship10-240x136.png',\n\t\t'spaceship14-240x185.png',\n\t\t'spaceship15-215x240.png',\n\t\t'spaceship16-140x240.png',\n\t\t'spaceship2-300x126.png',\n\t\t'spaceship8-240x146.png',\n\t\t'spaceship9-240x154.png',\n\t\t'rocketship2-159x300.png'\n    ];\n\tPLANET_IMAGES: string[] = [\n\t\t'callisto-240x240.png',\n\t\t'earth30-240x240.png',\n\t\t'europa-240x240.png',\n\t\t'jupiter5-240x218.png',\n\t\t'jupiter6-240x231.png',\n\t\t'mars3-240x240.png',\n\t\t'mars5-240x236.png',\n\t\t'mars6-240x240.png',\n\t\t'moon17-240x236.png',\n\t\t'moon18.png',\n\t\t'neptune4-240x221.png',\n\t\t'planet5-240x233.png',\n\t\t'planet6.png',\n\t\t'planet9-240x223.png',\n\t\t'planet10-240x240.png',\n\t\t'planet12-240x240.png',\n\t\t'planet13-240x238.png',\n\t\t'saturn3-240x114.png',\n\t\t'saturn5-300x124.png'\n\t];\n\tboomDuration: number = 2000;\n\n\tconstructor(private authService: AuthService, private af: AngularFire) {\n\t\tthis.spaceObjects$ = this.af.database.list('/space-objects') as FirebaseListObservable<ISpaceObject[]>;\n\t\tthis.spaceObjects$.subscribe(objects => {\n\t\t\tthis.spaceObjects = objects;\n\t\t});\n\t}\n\n\tcreateAIShip(x, y): void {\n\t\tthis.registerObject(new AIShip(x, y, this.SHIP_IMAGES[Math.floor(Math.random() * this.SHIP_IMAGES.length)]));\n\t}\n\n\tcreateAsteroid(x, y): void {\n\t\tthis.registerObject(new Asteroid(x, y));\n\t}\n\n\tcreatePlanet(x, y, image): void {\n\t\tif (!image) {\n\t\t\timage = this.PLANET_IMAGES[Math.floor(Math.random() * this.PLANET_IMAGES.length)];\n\t\t}\n\t\tthis.registerObject(new Planet(x, y, image));\n\t}\n\n\tcreateBoom(x, y, hit, facing): void {\n\t\tlet image = 'fireworks6-150x150.png';\n\t\tif (hit) {\n\t\t\timage = 'explosion5-150x150.png';\n\t\t}\n\t\tthis.registerObject(new Explosion(x, y, image, facing)).then((boom: any) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.spaceObjects$.remove(boom.path.u[1]);\n\t\t\t}, this.boomDuration);\n\t\t}) as any;\n\t}\n\n\tregisterObject(obj: ISpaceObject) {\n\t\treturn this.spaceObjects$.push(obj);\n\t}\n\n\tregisterShip(ship: User) {\n\t\tif (!ship.$key) {\n\t\t\treturn this.spaceObjects$.push(ship);\n\t\t}\n\t}\n\n\tdamage(ship: AIShip) {\n\t\tif (ship.health > 0) {\n\t\t\tthis.spaceObjects$.update(ship.$key, {\n\t\t\t\thealth: ship.health\n\t\t\t});\n\t\t} else {\n\t\t\tthis.spaceObjects$.remove(ship.$key);\n\t\t}\n\t}\n\n}\n"]}